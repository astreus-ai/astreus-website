---
title: Custom Table Names Guide
description: Learn how to customize table names for all Astreus components to organize your data and avoid conflicts
---

This guide shows you how to use custom table names throughout the Astreus framework to organize your data, avoid conflicts, and integrate with existing systems.

## Why Use Custom Table Names?

Custom table names are useful for:

- **Avoiding Conflicts**: Multiple applications sharing the same database
- **Organization**: Grouping related tables with prefixes
- **Multi-tenancy**: Separating data for different clients or environments
- **Legacy Integration**: Working with existing database schemas
- **Environment Separation**: Different table names for dev/staging/production

## Database System Tables

Configure custom names for core system tables:

```typescript
import { createDatabase } from '@astreus-ai/astreus';

const database = await createDatabase({
  type: 'sqlite',
  connection: { filename: './my-app.db' },
  tableNames: {
    agents: 'my_agents',      // Default: 'agents'
    users: 'my_users',        // Default: 'users'
    tasks: 'my_tasks'         // Default: 'tasks'
  }
});

// Check configured table names
console.log(database.getTableNames());
// Output: { agents: 'my_agents', users: 'my_users', tasks: 'my_tasks' }
```

## Memory Table Names

Customize the table name for conversation storage:

```typescript
import { createMemory } from '@astreus-ai/astreus';

const memory = await createMemory({
  database,
  tableName: 'my_conversations',  // Default: 'memories'
  maxEntries: 1000
});
```

## Chat Management Table Names

Set custom table names for chat metadata:

```typescript
import { createChat } from '@astreus-ai/astreus';

const chat = await createChat({
  database,
  memory,
  tableName: 'my_chats',  // Default: 'chats'
  maxChats: 100
});
```

## Complete Example with Prefixes

Here's a complete example using consistent prefixes:

```typescript
import { 
  createDatabase, 
  createMemory, 
  createChat, 
  createAgent,
  createProvider 
} from '@astreus-ai/astreus';

async function setupWithCustomTables() {
  // 1. Database with prefixed system tables
  const database = await createDatabase({
    type: 'sqlite',
    connection: { filename: './myapp.db' },
    tableNames: {
      agents: 'myapp_agents',
      users: 'myapp_users',
      tasks: 'myapp_tasks'
    }
  });

  // 2. Memory with custom table
  const memory = await createMemory({
    database,
    tableName: 'myapp_conversations',
    maxEntries: 1000,
    enableEmbeddings: true
  });

  // 3. Chat management with custom table
  const chat = await createChat({
    database,
    memory,
    tableName: 'myapp_chats',
    autoGenerateTitles: true
  });

  // 4. Create provider and agent
  const provider = createProvider({
    type: 'openai',
    model: 'gpt-4'
  });

  const agent = await createAgent({
    name: 'MyAppAgent',
    description: 'Customer support agent',
    provider,
    memory,
    database,
    systemPrompt: 'You are a helpful customer support agent.'
  });

  return { database, memory, chat, agent };
}
```

## Multi-Environment Setup

Use different table names for different environments:

```typescript
// config/database.ts
const getTableConfig = (environment: string) => {
  const prefix = environment === 'production' ? 'prod' : environment;
  
  return {
    agents: `${prefix}_agents`,
    users: `${prefix}_users`,
    tasks: `${prefix}_tasks`,
    memories: `${prefix}_conversations`,
    chats: `${prefix}_chats`
  };
};

// Usage
const env = process.env.NODE_ENV || 'development';
const tableConfig = getTableConfig(env);

const database = await createDatabase({
  type: 'postgresql',
  connection: process.env.DATABASE_URL,
  tableNames: {
    agents: tableConfig.agents,
    users: tableConfig.users,
    tasks: tableConfig.tasks
  }
});

const memory = await createMemory({
  database,
  tableName: tableConfig.memories
});

const chat = await createChat({
  database,
  memory,
  tableName: tableConfig.chats
});
```

## Multi-Tenant Application

Separate data for different tenants:

```typescript
async function createTenantResources(tenantId: string) {
  const database = await createDatabase({
    type: 'postgresql',
    connection: process.env.DATABASE_URL,
    tableNames: {
      agents: `tenant_${tenantId}_agents`,
      users: `tenant_${tenantId}_users`,
      tasks: `tenant_${tenantId}_tasks`
    }
  });

  const memory = await createMemory({
    database,
    tableName: `tenant_${tenantId}_conversations`
  });

  const chat = await createChat({
    database,
    memory,
    tableName: `tenant_${tenantId}_chats`
  });

  return { database, memory, chat };
}

// Usage
const tenant1Resources = await createTenantResources('company_a');
const tenant2Resources = await createTenantResources('company_b');
```

## Legacy System Integration

Integrate with existing database schemas:

```typescript
// Existing database has tables: legacy_users, legacy_conversations
const database = await createDatabase({
  type: 'postgresql',
  connection: process.env.DATABASE_URL,
  tableNames: {
    agents: 'astreus_agents',        // New table
    users: 'legacy_users',           // Existing table
    tasks: 'astreus_tasks'           // New table
  }
});

const memory = await createMemory({
  database,
  tableName: 'legacy_conversations'  // Use existing table
});
```

## Best Practices

### 1. Use Consistent Naming Conventions

```typescript
// Good: Consistent prefixes
const tableNames = {
  agents: 'myapp_agents',
  users: 'myapp_users',
  tasks: 'myapp_tasks',
  memories: 'myapp_conversations',
  chats: 'myapp_chats'
};

// Avoid: Inconsistent naming
const badNames = {
  agents: 'agents_table',
  users: 'user_data',
  tasks: 'task_info'
};
```

### 2. Document Your Schema

```typescript
// schema.md or schema.ts
export const TABLE_SCHEMA = {
  // System tables
  agents: 'myapp_agents',
  users: 'myapp_users', 
  tasks: 'myapp_tasks',
  
  // Application tables
  conversations: 'myapp_conversations',
  chats: 'myapp_chats',
  
  // Feature-specific tables
  knowledge_base: 'myapp_knowledge',
  analytics: 'myapp_analytics'
};
```

### 3. Use Environment Variables

```typescript
// .env
MYAPP_TABLE_PREFIX=myapp
NODE_ENV=development

// config.ts
const tablePrefix = process.env.MYAPP_TABLE_PREFIX || 'astreus';
const env = process.env.NODE_ENV || 'development';

export const getTableName = (baseName: string) => {
  if (env === 'test') {
    return `test_${baseName}`;
  }
  return `${tablePrefix}_${baseName}`;
};
```

### 4. Validate Table Names

```typescript
const validateTableName = (name: string) => {
  // Check for valid SQL identifier
  if (!/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(name)) {
    throw new Error(`Invalid table name: ${name}`);
  }
  
  // Check length limits
  if (name.length > 63) { // PostgreSQL limit
    throw new Error(`Table name too long: ${name}`);
  }
  
  return name;
};

const tableNames = {
  agents: validateTableName('myapp_agents'),
  users: validateTableName('myapp_users'),
  tasks: validateTableName('myapp_tasks')
};
```

## Migration Strategies

### Renaming Existing Tables

```sql
-- PostgreSQL
ALTER TABLE memories RENAME TO myapp_conversations;
ALTER TABLE chats RENAME TO myapp_chats;

-- SQLite (requires recreation)
ALTER TABLE memories RENAME TO memories_old;
-- Create new table with desired name
-- Copy data
-- Drop old table
```

### Gradual Migration

```typescript
// Phase 1: Create new tables alongside old ones
const database = await createDatabase({
  tableNames: {
    agents: 'v2_agents',  // New schema
    users: 'users',       // Keep existing
    tasks: 'v2_tasks'     // New schema
  }
});

// Phase 2: Migrate data
// Phase 3: Switch to new tables
// Phase 4: Drop old tables
```

## Troubleshooting

### Common Issues

1. **Table Name Conflicts**
   ```typescript
   // Error: Table 'users' already exists
   // Solution: Use unique prefixes
   tableNames: { users: 'myapp_users' }
   ```

2. **Invalid Characters**
   ```typescript
   // Error: Invalid table name 'my-app-users'
   // Solution: Use underscores
   tableName: 'my_app_users'
   ```

3. **Case Sensitivity**
   ```typescript
   // PostgreSQL is case-sensitive
   // Use lowercase for consistency
   tableName: 'myapp_users' // Good
   tableName: 'MyApp_Users' // Avoid
   ```

### Debugging

```typescript
// Check what tables were created
const tableNames = database.getTableNames();
console.log('System tables:', tableNames);

// Verify table existence
const hasTable = await database.knex.schema.hasTable('myapp_conversations');
console.log('Table exists:', hasTable);

// List all tables in database
const tables = await database.knex.raw(`
  SELECT table_name 
  FROM information_schema.tables 
  WHERE table_schema = 'public'
`);
console.log('All tables:', tables.rows);
```

Custom table names provide flexibility and organization for your Astreus applications. Choose a consistent naming strategy that fits your project's needs and stick to it throughout your application. 